using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using {{Params.CoreProjectName}}.Context;
using {{Params.CoreProjectName}}.Models;
using {{Params.CoreProjectName}}.Interfaces;
using {{Params.CoreProjectName}}.Services;
using {{Params.CoreProjectName}}.Services.Generated;

namespace {{Params.WebApiProjectName}}.Extensions
{
	/// <summary>
    /// Autogenerated.
    /// </summary>
    public static class StartupExtensions
    {
        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.
        public static IServiceCollection AddGeneratedServices(this IServiceCollection services)
        {
            services.AddScoped(typeof(IRepository<,>), typeof(DbRepository<,>));
			services.AddScoped<RepositorySet>();

			{%- for entity in Params.Entities -%}
			services.AddScoped<ICrudService<{{entity.Name}}, {{entity.IdField.Type.Name}}>, {{entity.Name}}CrudService>();
			{%- endfor -%}

			return services;
        }
    }
}
